SELECT DISTINCT BIF030.C_ACCOUNT AS ACCOUNTNUMBER,
	BIF003.C_ACCOUNTTYPE AS ACCOUNTTYPECODE,
	CON013.C_DESCRIPTION AS ACCOUNTTYPE,
	BIF003.C_DIVISION AS ZONE_DIVISONCODE,
	CON028.C_DESCRIPTION AS ZONE_DIVISION,
	BIF030.C_METER as METERNUMBER,
	NULL AS REGISTERNUMBER,
	CONVERT(DECIMAL(20,2), BIF030.N_CONSUMP) AS CONSUMPTION,       
	CON007.C_DESCRIPTION AS UNITS,       
	BIF030.T_READDATE AS READINGDATE,
	MONTH(BIF030.T_READDATE) AS READINGMONTH,
	DAY(BIF030.T_READDATE) AS READINGDAY,
	YEAR(BIF030.T_READDATE) AS READINGYEAR,
	BIF030.I_DAYS AS READINGDAYSCOUNT,
	CASE
		WHEN MONTH(BIF030.T_READDATE) = 7 THEN 1
		WHEN MONTH(BIF030.T_READDATE) = 8 THEN 2
		WHEN MONTH(BIF030.T_READDATE) = 9 THEN 3
		WHEN MONTH(BIF030.T_READDATE) = 10 THEN 4
		WHEN MONTH(BIF030.T_READDATE) = 11 THEN 5
		WHEN MONTH(BIF030.T_READDATE) = 12 THEN 6
		WHEN MONTH(BIF030.T_READDATE) = 1 THEN 7
		WHEN MONTH(BIF030.T_READDATE) = 2 THEN 8
		WHEN MONTH(BIF030.T_READDATE) = 3 THEN 9
		WHEN MONTH(BIF030.T_READDATE) = 4 THEN 10
		WHEN MONTH(BIF030.T_READDATE) = 5 THEN 11
		WHEN MONTH(BIF030.T_READDATE) = 6 THEN 12
		ELSE NULL
		END AS FISCALMONTH,
		CASE
		WHEN MONTH(BIF030.T_READDATE) = 7 THEN YEAR(BIF030.T_READDATE) + 1
		WHEN MONTH(BIF030.T_READDATE) = 8 THEN YEAR(BIF030.T_READDATE) + 1
		WHEN MONTH(BIF030.T_READDATE) = 9 THEN YEAR(BIF030.T_READDATE) + 1
		WHEN MONTH(BIF030.T_READDATE) = 10 THEN YEAR(BIF030.T_READDATE) + 1
		WHEN MONTH(BIF030.T_READDATE) = 11 THEN YEAR(BIF030.T_READDATE) + 1
		WHEN MONTH(BIF030.T_READDATE) = 12 THEN YEAR(BIF030.T_READDATE) + 1
		WHEN MONTH(BIF030.T_READDATE) = 1 THEN YEAR(BIF030.T_READDATE)
		WHEN MONTH(BIF030.T_READDATE) = 2 THEN YEAR(BIF030.T_READDATE)
		WHEN MONTH(BIF030.T_READDATE) = 3 THEN YEAR(BIF030.T_READDATE)
		WHEN MONTH(BIF030.T_READDATE) = 4 THEN YEAR(BIF030.T_READDATE)
		WHEN MONTH(BIF030.T_READDATE) = 5 THEN YEAR(BIF030.T_READDATE)
		WHEN MONTH(BIF030.T_READDATE) = 6 THEN YEAR(BIF030.T_READDATE)
		ELSE NULL
		END AS FISCALYEAR
	
	  INTO water.dbo.Consumption_By_Account FROM ADVANCED.BIF030
		LEFT JOIN ADVANCED.CON007 ON CON007.C_UNITS=BIF030.C_UNITS
		LEFT JOIN ADVANCED.BIF005 ON BIF005.C_METER=BIF030.C_METER
		LEFT JOIN ADVANCED.BIF003 ON BIF003.C_ACCOUNT=BIF030.C_ACCOUNT
		LEFT JOIN ADVANCED.CON013 ON CON013.C_ACCOUNTTYPE=BIF003.C_ACCOUNTTYPE
		LEFT JOIN ADVANCED.CON028 ON CON028.C_DIVISION=BIF003.C_DIVISION
		
	WHERE T_READDATE > '01-01-2014' AND BIF030.C_CUSTOMER = BIF003.C_CUSTOMER
	
	ORDER BY ACCOUNTNUMBER, READINGDATE ASC
